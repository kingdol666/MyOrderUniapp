"use strict";const e=require("../../common/vendor.js"),n=require("../../api/index.js"),i=require("../../store/index.js");if(!Array){(e.resolveComponent("uni-icons")+e.resolveComponent("uni-search-bar")+e.resolveComponent("uni-grid-item")+e.resolveComponent("uni-grid")+e.resolveComponent("uni-badge"))()}Math||((()=>"../../uni_modules/uni-icons/components/uni-icons/uni-icons.js")+(()=>"../../uni_modules/uni-search-bar/components/uni-search-bar/uni-search-bar.js")+(()=>"../../uni_modules/uni-grid/components/uni-grid-item/uni-grid-item.js")+(()=>"../../uni_modules/uni-grid/components/uni-grid/uni-grid.js")+(()=>"../../uni_modules/uni-badge/components/uni-badge/uni-badge.js"))();const o={__name:"index",setup(o){const t=e.ref(""),a=e.ref(0),r=e.ref([{imageUrl:"/static/banner1.jpg"},{imageUrl:"/static/banner2.jpg"},{imageUrl:"/static/banner3.jpg"}]),s=e.ref([{id:1,name:"热菜",icon:"/static/icons/hot.png"},{id:2,name:"凉菜",icon:"/static/icons/cold.png"},{id:3,name:"主食",icon:"/static/icons/staple.png"},{id:4,name:"汤类",icon:"/static/icons/drink.png"}]),c=e.ref([]),u=e.ref([]),d=e.ref(["红烧肉","宫保鸡丁","水煮鱼","麻婆豆腐","炒青菜"]),l=e=>{a.value=e.detail.current},m=e=>e<3?["rank-1","rank-2","rank-3"][e]:"",p=()=>{t.value.trim()?e.index.navigateTo({url:`/pages/menu/detail?keyword=${encodeURIComponent(t.value)}`}):e.index.showToast({title:"请输入搜索关键词",icon:"none"})},g=n=>{e.index.navigateTo({url:`/pages/menu/detail?id=${n.id}`})},f=()=>{e.index.switchTab({url:"/pages/menu/menu"})},v=async o=>{try{const t=i.store.getUserId();if(!t)return void e.index.showModal({title:"提示",content:"请先登录后再操作",confirmText:"去登录",success:n=>{n.confirm&&e.index.switchTab({url:"/pages/user/user"})}});await n.cartApi.saveCartItem({userId:t,menuItemId:o.id,quantity:1}),e.index.showToast({title:"已加入购物车",icon:"success"})}catch(t){console.error("添加失败:",t),e.index.showToast({title:"添加失败",icon:"none"})}};return e.onMounted((()=>{(async()=>{try{const e=await n.menuApi.getRecommendItems();c.value=e.data}catch(i){console.error("推荐菜品加载失败:",i),e.index.showToast({title:"加载推荐菜品失败",icon:"none"})}})(),(async()=>{try{const e=await n.menuApi.getHotItems(0,10);u.value=e.data||[]}catch(i){console.error("热销菜品加载失败:",i),e.index.showToast({title:"加载热销菜品失败",icon:"none"}),u.value=[]}})()})),(n,o)=>e.e({a:e.p({color:"#666",size:"18",type:"search"}),b:e.o(p),c:e.o((e=>t.value=e)),d:e.p({radius:100,placeholder:"搜索你喜欢的美食",bgColor:"#ffffff",focus:!1,modelValue:t.value}),e:e.f(r.value,((e,n,i)=>({a:e.imageUrl,b:n}))),f:e.o(l),g:e.f(r.value,((e,n,i)=>({a:n,b:a.value===n?1:""}))),h:e.f(s.value,((n,o,t)=>({a:n.icon,b:e.t(n.name),c:e.o((o=>{return t=n,console.log("点击分类:",t),i.store.setCurrentCategoryId(t.id),console.log("当前分类ID:",i.store.getCurrentCategoryId()),void e.index.switchTab({url:"/pages/menu/menu"});var t}),n.id),d:n.id,e:"5a0f5e97-3-"+t+",5a0f5e97-2"}))),i:e.p({column:4,highlight:!1,showBorder:!1}),j:e.p({type:"right",size:"14",color:"#666"}),k:e.o(f),l:e.f(c.value,((n,i,o)=>({a:n.imageUrl,b:e.t(n.name),c:e.t(n.description),d:e.t(n.price),e:"5a0f5e97-5-"+o,f:e.o((e=>v(n)),n.id),g:n.id,h:e.o((e=>g(n)),n.id)}))),m:e.p({type:"plus",size:"20",color:"#ffffff"}),n:e.p({text:u.value.length,type:"primary",size:"small"}),o:e.f(u.value,((n,i,o)=>({a:e.t(i+1),b:e.n(m(i)),c:n.imageUrl,d:e.t(n.name),e:e.t(n.description),f:e.t(n.price),g:"5a0f5e97-7-"+o,h:e.o((e=>v(n)),n.id),i:n.id,j:e.o((e=>g(n)),n.id)}))),p:e.p({type:"plus",size:"20",color:"#ffffff"}),q:d.value.length},d.value.length?{r:e.f(d.value,((n,i,o)=>({a:e.t(n),b:i,c:e.o((e=>(e=>{t.value=e,p()})(n)),i)})))}:{})}},t=e._export_sfc(o,[["__scopeId","data-v-5a0f5e97"]]);wx.createPage(t);
