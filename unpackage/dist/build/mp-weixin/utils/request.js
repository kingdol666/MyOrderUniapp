"use strict";const e=require("../common/vendor.js"),t=t=>{let o="https://your-production-domain.com/api"+t.url;if(t.params){const e=Object.entries(t.params).map((([e,t])=>`${e}=${encodeURIComponent(t)}`)).join("&");o+=`?${e}`}return new Promise(((r,a)=>{const n=e.index.getStorageSync("token"),s={"Content-Type":"application/json"};n&&(s.Authorization=`Bearer ${n}`),e.index.request({...t,url:o,header:s,timeout:15e3,success:t=>{t.statusCode>=200&&t.statusCode<300?r(t.data):401===t.statusCode?(e.index.removeStorageSync("token"),e.index.removeStorageSync("userInfo"),e.index.showToast({title:"请重新登录",icon:"none"}),a(new Error("未授权"))):a(new Error(t.data.message||"请求失败"))},fail:e=>{console.error("请求失败:",e),a(new Error("网络请求失败"))}})}))},o={get:(e,o={},r={})=>t({url:e,method:"GET",data:o,params:r}),post:(e,o={},r={})=>t({url:e,method:"POST",data:o,params:r}),put:(e,o={})=>t({url:e,method:"PUT",data:o}),delete:(e,o={})=>t({url:e,method:"DELETE",data:o})};exports.request=o;
